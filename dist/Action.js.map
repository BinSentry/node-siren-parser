{"version":3,"sources":["../src/Action.js"],"names":["Action","action","JSON","stringify","name","href","Array","isArray","method","title","type","fields","_fieldsByName","_fieldsByClass","_fieldsByType","forEach","field","fieldInstance","Field","push","cls","prototype","toJSON","hasClass","hasField","fieldName","hasFieldByName","hasFieldByClass","fieldClass","hasFieldByType","fieldType","getField","getFieldByName","getFieldByClass","vals","undefined","getFieldsByClass","slice","getFieldByClasses","fieldClasses","length","getFieldsByClasses","getFieldByType","getFieldsByType"],"mappings":"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","sourcesContent":["import assert from './assert';\nimport {contains, getMatchingValue, getMatchingValuesByAll, hasProperty} from './util.js';\nimport Field from './Field';\n\nexport default function Action(action) {\n\tif (action instanceof Action) {\n\t\treturn action;\n\t}\n\tif (!(this instanceof Action)) {\n\t\treturn new Action(action);\n\t}\n\n\tassert('object' === typeof action, 'action must be an object, got ' + JSON.stringify(action));\n\tassert('string' === typeof action.name, 'action.name must be a string, got ' + JSON.stringify(action.name));\n\tassert('string' === typeof action.href, 'action.href must be a string, got ' + JSON.stringify(action.href));\n\tassert('undefined' === typeof action.class || Array.isArray(action.class),\n\t\t'action.class must be an array or undefined, got ' + JSON.stringify(action.class));\n\tassert('undefined' === typeof action.method || 'string' === typeof action.method,\n\t\t'action.method must be a string or undefined, got ' + JSON.stringify(action.method));\n\tassert('undefined' === typeof action.title || 'string' === typeof action.title,\n\t\t'action.title must be a string or undefined, got ' + JSON.stringify(action.title));\n\tassert('undefined' === typeof action.type || 'string' === typeof action.type,\n\t\t'action.type must be a string or undefined, got ' + JSON.stringify(action.type));\n\tassert('undefined' === typeof action.fields || Array.isArray(action.fields),\n\t\t'action.fields must be an array or undefined, got ' + JSON.stringify(action.fields));\n\n\tthis.name = action.name;\n\tthis.href = action.href;\n\n\tif (action.class) {\n\t\tthis.class = action.class;\n\t}\n\n\tthis.method = action.method || 'GET';\n\n\tif (action.title) {\n\t\tthis.title = action.title;\n\t}\n\n\tthis.type = action.type || 'application/x-www-form-urlencoded';\n\n\tthis._fieldsByName = {};\n\tthis._fieldsByClass = {};\n\tthis._fieldsByType = {};\n\tif (action.fields) {\n\t\tthis.fields = [];\n\n\t\taction.fields.forEach(field => {\n\t\t\tconst fieldInstance = new Field(field);\n\t\t\tthis.fields.push(fieldInstance);\n\n\t\t\tthis._fieldsByName[field.name] = fieldInstance;\n\n\t\t\tif (fieldInstance.type) {\n\t\t\t\tthis._fieldsByType[fieldInstance.type] = this._fieldsByType[fieldInstance.type] || [];\n\t\t\t\tthis._fieldsByType[fieldInstance.type].push(fieldInstance);\n\t\t\t}\n\n\t\t\tif (fieldInstance.class) {\n\t\t\t\tfieldInstance.class.forEach(cls => {\n\t\t\t\t\tthis._fieldsByClass[cls] = this._fieldsByClass[cls] || [];\n\t\t\t\t\tthis._fieldsByClass[cls].push(fieldInstance);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n}\n\nAction.prototype.toJSON = function() {\n\treturn {\n\t\tname: this.name,\n\t\thref: this.href,\n\t\tclass: this.class,\n\t\tmethod: this.method,\n\t\ttitle: this.title,\n\t\ttype: this.type,\n\t\tfields: this.fields\n\t};\n};\n\nAction.prototype.hasClass = function(cls) {\n\treturn this.class instanceof Array && contains(this.class, cls);\n};\n\nAction.prototype.hasField = function(fieldName) {\n\treturn this.hasFieldByName(fieldName);\n};\n\nAction.prototype.hasFieldByName = function(fieldName) {\n\treturn hasProperty(this._fieldsByName, fieldName);\n};\n\nAction.prototype.hasFieldByClass = function(fieldClass) {\n\treturn hasProperty(this._fieldsByClass, fieldClass);\n};\n\nAction.prototype.hasFieldByType = function(fieldType) {\n\treturn hasProperty(this._fieldsByType, fieldType);\n};\n\nAction.prototype.getField = function(fieldName) {\n\treturn this.getFieldByName(fieldName);\n};\n\nAction.prototype.getFieldByName = function(fieldName) {\n\treturn getMatchingValue(this._fieldsByName, fieldName);\n};\n\nAction.prototype.getFieldByClass = function(fieldClass) {\n\tconst vals = getMatchingValue(this._fieldsByClass, fieldClass);\n\treturn vals ? vals[0] : undefined;\n};\n\nAction.prototype.getFieldsByClass = function(fieldClass) {\n\tconst vals = getMatchingValue(this._fieldsByClass, fieldClass);\n\treturn vals ? vals.slice() : [];\n};\n\nAction.prototype.getFieldByClasses = function(fieldClasses) {\n\tconst vals = getMatchingValuesByAll(this.fields, fieldClasses, 'class');\n\treturn vals && vals.length > 0 ? vals[0] : undefined;\n};\n\nAction.prototype.getFieldsByClasses = function(fieldClasses) {\n\tconst vals = getMatchingValuesByAll(this.fields, fieldClasses, 'class');\n\treturn vals && vals.length > 0 ? vals.slice() : [];\n};\n\nAction.prototype.getFieldByType = function(fieldType) {\n\tconst vals = getMatchingValue(this._fieldsByType, fieldType);\n\treturn vals ? vals[0] : undefined;\n};\n\nAction.prototype.getFieldsByType = function(fieldType) {\n\tconst vals = getMatchingValue(this._fieldsByType, fieldType);\n\treturn vals ? vals.slice() : [];\n};\n"],"file":"Action.js"}